<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Plotting results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="plotting_results_files/libs/clipboard/clipboard.min.js"></script>
<script src="plotting_results_files/libs/quarto-html/quarto.js"></script>
<script src="plotting_results_files/libs/quarto-html/popper.min.js"></script>
<script src="plotting_results_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="plotting_results_files/libs/quarto-html/anchor.min.js"></script>
<link href="plotting_results_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="plotting_results_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="plotting_results_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="plotting_results_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="plotting_results_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Plotting results</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hello Max!</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> agent <span class="im">import</span> Agent</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> model <span class="im">import</span> Model</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hybrid_networks <span class="im">import</span> create_hybrid_network</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hybrid_networks_clean <span class="im">import</span> rewire_network, randomize_network_v2, create_hybrid_network</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext autoreload</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>autoreload <span class="dv">2</span>                      </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> opinionated</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"opinionated_j"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> colormaps <span class="im">as</span> cmaps </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Now downloading: Roboto Condensed
Added new font as Roboto Condensed Light
Added new font as Roboto Condensed
Added new font as Roboto Condensed
Added new font as Roboto Condensed Black
Now downloading: Montserrat
Added new font as Montserrat Thin Light
Added new font as Montserrat Thin
Added new font as Montserrat Thin
Added new font as Montserrat Thin Black
Now downloading: Source Code Pro
Added new font as Source Code Pro ExtraLight Light
Added new font as Source Code Pro ExtraLight
Added new font as Source Code Pro ExtraLight
Added new font as Source Code Pro ExtraLight Black
Now downloading: Fira Sans
Added new font as Fira Sans Light
Added new font as Fira Sans
Added new font as Fira Sans
Added new font as Fira Sans Black
Now downloading: Fira Sans Condensed
Added new font as Fira Sans Condensed Light
Added new font as Fira Sans Condensed
Added new font as Fira Sans Condensed
Added new font as Fira Sans Condensed Black
Now downloading: IBM Plex Sans
Added new font as IBM Plex Sans Light
Added new font as IBM Plex Sans
Added new font as IBM Plex Sans
Now downloading: Space Grotesk
Added new font as Space Grotesk Light Light
Added new font as Space Grotesk Light
Added new font as Space Grotesk Light
Now downloading: Space Mono
Added new font as Space Mono
Added new font as Space Mono
Now downloading: Roboto
Added new font as Roboto Light
Added new font as Roboto
Added new font as Roboto
Added new font as Roboto Black
Now downloading: Jost
Added new font as Jost Light
Added new font as Jost
Added new font as Jost
Added new font as Jost Black
Now downloading: Titillium Web
Added new font as Titillium Web Light
Added new font as Titillium Web
Added new font as Titillium Web
Added new font as Titillium Web Black</code></pre>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>output_dir <span class="op">=</span> <span class="st">'talk_munich/images/'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pygam <span class="im">import</span> LogisticGAM,LinearGAM, s   </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="op">=</span> pd.read_csv(<span class="st">'bayesagent_perceptron_results_df.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-7" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dill</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Use dill to deserialize the graph from a file</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data_proc/perceptron_graph_pre_1979.pkl'</span>, <span class="st">'rb'</span>) <span class="im">as</span> f:</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    G_perceptron <span class="op">=</span> dill.load(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>randomize_by <span class="op">=</span> [<span class="dv">0</span>,<span class="fl">.2</span>,<span class="fl">.4</span>,<span class="fl">.6</span>,<span class="fl">.8</span>,<span class="fl">1.</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> graph_tool.<span class="bu">all</span> <span class="im">as</span> gt</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> this_rand_value <span class="kw">in</span> randomize_by:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    G_randomized <span class="op">=</span> randomize_network_v2(G_perceptron, p_rewiring<span class="op">=</span>this_rand_value)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert NetworkX graph to graph_tool graph</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> gt.Graph(directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a mapping from NetworkX nodes to graph_tool vertices</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    node_map <span class="op">=</span> {n: g.add_vertex() <span class="cf">for</span> n <span class="kw">in</span> G_randomized.nodes()}</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add edges to the graph_tool graph</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> u, v <span class="kw">in</span> G_randomized.edges():</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        g.add_edge(node_map[u], node_map[v])</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> gt.sfdp_layout(g)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    dprms <span class="op">=</span> <span class="bu">dict</span>(fmt<span class="op">=</span><span class="st">"png"</span>,  output_size<span class="op">=</span>(<span class="dv">1200</span>, <span class="dv">1200</span>))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    gt.graph_draw( g, pos, output <span class="op">=</span>output_dir <span class="op">+</span> <span class="ss">f"perceptron_graph_randomized_p=</span><span class="sc">{</span>this_rand_value<span class="sc">}</span><span class="ss">.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-10" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> powerlaw</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_loglog(G, filename<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate degree frequency</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    degree_freq <span class="op">=</span> nx.degree_histogram(G)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    degrees <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(degree_freq))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(degree_freq)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out zero frequencies to avoid issues in loglog plots and fitting</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    nonzero_degrees <span class="op">=</span> [degree <span class="cf">for</span> degree, freq <span class="kw">in</span> <span class="bu">enumerate</span>(degree_freq) <span class="cf">if</span> freq <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    nonzero_freqs <span class="op">=</span> [freq <span class="cf">for</span> freq <span class="kw">in</span> degree_freq <span class="cf">if</span> freq <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the power law model to the nonzero frequencies</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> powerlaw.Fit(nonzero_freqs, discrete<span class="op">=</span><span class="va">True</span>, xmin<span class="op">=</span><span class="bu">min</span>(nonzero_degrees))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    alpha, sigma <span class="op">=</span> fit.alpha, fit.sigma</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Alpha: </span><span class="sc">{</span>alpha<span class="sc">}</span><span class="ss">, Sigma: </span><span class="sc">{</span>sigma<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the original degree distribution</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    plt.loglog(nonzero_degrees, [d <span class="op">/</span> <span class="bu">len</span>(G)  <span class="cf">for</span> d <span class="kw">in</span> nonzero_freqs], <span class="st">'o'</span>, c<span class="op">=</span><span class="st">'#ab0b00'</span>, alpha<span class="op">=</span><span class="fl">.9</span>, label<span class="op">=</span><span class="st">'Degree distribution'</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate and plot the power law trend line over the observed range</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(nonzero_degrees)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.loglog(nonzero_degrees, [fit.power_law.pdf(d)  for d in nonzero_degrees], 'k-', label=f'Power law fit (α={np.round(alpha,2)})')</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Degree'</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Frequency of Degree'</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>   <span class="co">#plt.legend(pos,loc='upper right')</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> filename <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        plt.savefig(filename, dpi<span class="op">=</span><span class="dv">300</span>, transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.show()</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> this_rand_value <span class="kw">in</span> randomize_by:</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    G_randomized <span class="op">=</span> randomize_network_v2(G_perceptron, p_rewiring<span class="op">=</span>this_rand_value)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    plot_loglog(G_randomized, filename <span class="op">=</span> output_dir <span class="op">+</span> <span class="ss">f"perceptron_graph_randomized_p=</span><span class="sc">{</span>this_rand_value<span class="sc">}</span><span class="ss">_powerlaw_fit.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0, 1825, 664, 343, 157, 109, 37, 39, 48, 26, 17, 16, 13, 15, 7, 6, 15, 7, 9, 6, 13, 13, 10, 3, 4, 8, 10, 3, 8, 4, 3, 6, 3, 3, 2, 1, 4, 1, 2, 3, 1, 3, 4, 0, 1, 3, 3, 1, 3, 0, 3, 2, 0, 0, 2, 0, 0, 4, 1, 1, 1, 0, 0, 0, 0, 1, 3, 0, 0, 0, 2, 0, 0, 0, 2, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
Alpha: 1.462566072925915, Sigma: 0.05413926382925807
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 45, 46, 47, 48, 50, 51, 54, 57, 58, 59, 60, 65, 66, 70, 74, 75, 77, 78, 79, 81, 82, 93, 129, 136, 168, 185, 220, 253, 257, 493]
[150, 932, 900, 582, 355, 157, 76, 53, 32, 30, 19, 17, 16, 9, 13, 8, 7, 10, 9, 16, 5, 15, 12, 6, 6, 4, 2, 4, 1, 3, 2, 8, 3, 4, 3, 2, 0, 2, 6, 0, 2, 5, 0, 1, 2, 0, 1, 2, 1, 0, 1, 2, 3, 1, 0, 0, 0, 1, 0, 0, 1, 3, 0, 1, 2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
Calculating best minimal value for power law fit
Alpha: 1.5138407789113506, Sigma: 0.07576168959484554
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 40, 41, 43, 44, 46, 47, 48, 50, 51, 52, 53, 57, 60, 61, 63, 64, 67, 75, 110, 116, 138, 152, 178, 206, 211, 400]
[148, 538, 756, 743, 517, 297, 145, 68, 49, 35, 22, 24, 17, 9, 15, 9, 7, 11, 8, 17, 7, 9, 2, 4, 4, 3, 2, 2, 4, 5, 1, 6, 4, 2, 0, 0, 2, 0, 1, 3, 4, 0, 1, 0, 2, 0, 0, 1, 0, 1, 0, 1, 3, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
Calculating best minimal value for power law fit
Alpha: 1.3915008529421928, Sigma: 0.05327651797626482
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 36, 38, 39, 40, 42, 44, 47, 49, 51, 52, 53, 56, 83, 92, 96, 116, 143, 162, 172, 285]
[89, 389, 675, 690, 591, 421, 223, 133, 83, 35, 23, 28, 16, 24, 13, 9, 4, 9, 7, 5, 3, 5, 3, 4, 4, 2, 4, 3, 2, 1, 0, 2, 1, 2, 1, 1, 1, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
Calculating best minimal value for power law fit
Alpha: 1.378056265975364, Sigma: 0.05514517402222222
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 37, 38, 40, 52, 55, 67, 77, 90, 97, 105, 211]
[74, 260, 503, 678, 664, 503, 325, 194, 122, 70, 36, 16, 12, 14, 14, 3, 4, 5, 2, 2, 3, 4, 3, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
Calculating best minimal value for power law fit
Alpha: 1.3096952426656223, Sigma: 0.055622907595214446
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 26, 30, 35, 44, 47, 51, 59, 81]
[44, 201, 455, 623, 654, 593, 411, 266, 135, 81, 27, 21, 7, 1]
Calculating best minimal value for power law fit
Alpha: 1.470445914214822, Sigma: 0.13580603760554355
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data_df[<span class="st">'converged'</span>] <span class="op">=</span> data_df[<span class="st">'convergence_step'</span>]<span class="op">&lt;</span> <span class="dv">10000</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'N. unconverged simulations: '</span>, np.<span class="bu">sum</span>(<span class="op">~</span> data_df[<span class="st">'converged'</span>]))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>data_df[<span class="st">'share_of_correct_agents_at_conv'</span>] <span class="op">=</span> data_df[<span class="st">'true_consensus'</span>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>data_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>N. unconverged simulations:  2</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">n_agents</th>
<th data-quarto-table-cell-role="th">p_rewiring</th>
<th data-quarto-table-cell-role="th">uncertainty</th>
<th data-quarto-table-cell-role="th">n_experiments</th>
<th data-quarto-table-cell-role="th">rewiring_type</th>
<th data-quarto-table-cell-role="th">mean_degree</th>
<th data-quarto-table-cell-role="th">true_consensus</th>
<th data-quarto-table-cell-role="th">convergence_step</th>
<th data-quarto-table-cell-role="th">agent_type</th>
<th data-quarto-table-cell-role="th">converged</th>
<th data-quarto-table-cell-role="th">share_of_correct_agents_at_conv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3519</td>
<td>0.441173</td>
<td>0.016661</td>
<td>7427</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.773231</td>
<td>6</td>
<td>bayes</td>
<td>True</td>
<td>0.773231</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3519</td>
<td>0.817119</td>
<td>0.009739</td>
<td>1912</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.897698</td>
<td>28</td>
<td>bayes</td>
<td>True</td>
<td>0.897698</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3519</td>
<td>0.798491</td>
<td>0.022603</td>
<td>5749</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.903666</td>
<td>7</td>
<td>bayes</td>
<td>True</td>
<td>0.903666</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3519</td>
<td>0.384941</td>
<td>0.003522</td>
<td>5838</td>
<td>randomize</td>
<td>4.345553</td>
<td>0.705030</td>
<td>55</td>
<td>bayes</td>
<td>True</td>
<td>0.705030</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3519</td>
<td>0.404991</td>
<td>0.024896</td>
<td>5526</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.780619</td>
<td>6</td>
<td>bayes</td>
<td>True</td>
<td>0.780619</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1995</td>
<td>3519</td>
<td>0.583912</td>
<td>0.021065</td>
<td>4549</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.849957</td>
<td>7</td>
<td>bayes</td>
<td>True</td>
<td>0.849957</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1996</td>
<td>3519</td>
<td>0.188740</td>
<td>0.007631</td>
<td>7496</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.619494</td>
<td>14</td>
<td>bayes</td>
<td>True</td>
<td>0.619494</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1997</td>
<td>3519</td>
<td>0.847185</td>
<td>0.002986</td>
<td>757</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.874680</td>
<td>526</td>
<td>bayes</td>
<td>True</td>
<td>0.874680</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998</td>
<td>3519</td>
<td>0.145805</td>
<td>0.015593</td>
<td>352</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.557829</td>
<td>50</td>
<td>bayes</td>
<td>True</td>
<td>0.557829</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1999</td>
<td>3519</td>
<td>0.466978</td>
<td>0.003925</td>
<td>1815</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.729753</td>
<td>130</td>
<td>bayes</td>
<td>True</td>
<td>0.729753</td>
</tr>
</tbody>
</table>

<p>2000 rows × 11 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data_df[<span class="st">'convergence_step'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">"true_consensus"</span>, <span class="st">"choice_consensus"</span> <span class="kw">and</span> <span class="st">"convergence_step"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>('true_consensus', 'convergence_step')</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'uncertainty'</span>], data_df[<span class="st">'convergence_step'</span>], c<span class="op">=</span><span class="st">'#1a2340'</span>,alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Uncertainty'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Convergence Step'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs Convergence-Step'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="predicting-share_correct_at_convergence" class="level2">
<h2 class="anchored" data-anchor-id="predicting-share_correct_at_convergence">Predicting ‘share_correct_at_convergence’</h2>
<div id="cell-17" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_df[[<span class="st">'p_rewiring'</span>,  <span class="st">'uncertainty'</span>,  <span class="st">'n_experiments'</span> ]]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_df[<span class="st">'share_of_correct_agents_at_conv'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-18" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_agents'</span>: <span class="st">'Number of Agents'</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p_rewiring'</span>: <span class="st">'Probability of Rewiring'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'uncertainty'</span>: <span class="st">'Uncertainty (lower = harder)'</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_experiments'</span>: <span class="st">'Number of Experiments'</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'share_of_correct_agents_at_conv'</span>: <span class="st">'Share of correct agents'</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns in X for better readability</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>X.rename(columns<span class="op">=</span>rename_dict, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[col], y, c<span class="op">=</span><span class="st">'#1a2340'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(rename_dict.get(col, col))  <span class="co"># Use renamed label</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(rename_dict[<span class="st">'share_of_correct_agents_at_conv'</span>])</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_title(f'{rename_dict.get(col, col)}')</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    plt.gca().set_yticks([])</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>    plt.gca().set_yticklabels([])</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>plt.savefig(output_dir <span class="op">+</span> <span class="ss">f"perceptron_graph_randomized_pred_share_conv_data.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>, transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/2045109881.py:10: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  X.rename(columns=rename_dict, inplace=True)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LinearGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>)  ).fit(X_train, y_train)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on training data: {gam.accuracy(X_train, y_train)}")</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on test data: {gam.accuracy(X_test, y_test)}")</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinearGAM                                                                                                 
=============================================== ==========================================================
Distribution:                        NormalDist Effective DoF:                                      9.3633
Link Function:                     IdentityLink Log Likelihood:                               -118946.5835
Number of Samples:                          350 AIC:                                           237913.8935
                                                AICc:                                           237914.589
                                                GCV:                                                0.0015
                                                Scale:                                              0.0014
                                                Pseudo R-Squared:                                   0.9547
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            3.8          1.11e-16     ***         
s(1)                              [0.6]                6            2.8          1.11e-16     ***         
s(2)                              [0.6]                6            2.7          1.11e-16     ***         
intercept                                              1            0.0          1.11e-16     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/3553637546.py:9: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cmap<span class="op">=</span> cmaps.colorblind_10</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span>[cmap(<span class="dv">0</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">2</span>)]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose `gam` is your model and `gam.terms` contains the terms used in the model.</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># First, determine the number of plots (ignoring the intercept)</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="bu">sum</span>(<span class="kw">not</span> term.isintercept <span class="cf">for</span> term <span class="kw">in</span> gam.terms)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the figure</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store y-limits</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>y_limits <span class="op">=</span> []</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> X.columns</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co"># First pass: compute the y-axis limits for all plots</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    y_limits.append((<span class="bu">min</span>(pdep.<span class="bu">min</span>(), confi.<span class="bu">min</span>()), <span class="bu">max</span>(pdep.<span class="bu">max</span>(), confi.<span class="bu">max</span>())))</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Global y limits</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>global_y_min <span class="op">=</span> <span class="bu">min</span>(limit[<span class="dv">0</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>global_y_max <span class="op">=</span> <span class="bu">max</span>(limit[<span class="dv">1</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Second pass: plot with standardized y limits</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the subplot position</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">1</span>, plot_count, current_plot)</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], pdep,c<span class="op">=</span>colors[i])</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], confi, c<span class="op">=</span>colors[i], ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(XX[:, term.feature], confi[:, <span class="dv">0</span>], confi[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_y_min, global_y_max)  <span class="co"># Set global y limits</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.title(labels[i])</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(labels[i])  <span class="co"># Remove x-axis label</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.ylabel('')  # Remove y-axis label</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(<span class="st">'Isolated effect on share of corr. ag.'</span>)</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>    current_plot <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Move to the next plot position</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust subplots to fit into figure area.</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>plt.show()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="predicting-convergence-steps" class="level2">
<h2 class="anchored" data-anchor-id="predicting-convergence-steps">predicting convergence steps</h2>
<div id="cell-23" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_df[[<span class="st">'p_rewiring'</span>,  <span class="st">'uncertainty'</span>,  <span class="st">'n_experiments'</span> ]]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(data_df[<span class="st">'convergence_step'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-24" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_agents'</span>: <span class="st">'Number of Agents'</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p_rewiring'</span>: <span class="st">'Probability of Rewiring'</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'uncertainty'</span>: <span class="st">'Uncertainty (lower = harder)'</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_experiments'</span>: <span class="st">'Number of Experiments'</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'convergence_step'</span>: <span class="st">'Steps until convergence (log)'</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns in X for better readability</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>X.rename(columns<span class="op">=</span>rename_dict, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[col], y, c<span class="op">=</span><span class="st">'#1a2340'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(rename_dict.get(col, col))  <span class="co"># Use renamed label</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(rename_dict[<span class="st">'convergence_step'</span>])</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_title(f'{rename_dict.get(col, col)}')</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_yscale('log')  # Set y-scale to log for each axis</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/834728223.py:10: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  X.rename(columns=rename_dict, inplace=True)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-22-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LinearGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>)  ).fit(X_train, y_train)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on training data: {gam.accuracy(X_train, y_train)}")</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on test data: {gam.accuracy(X_test, y_test)}")</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinearGAM                                                                                                 
=============================================== ==========================================================
Distribution:                        NormalDist Effective DoF:                                      9.3633
Link Function:                     IdentityLink Log Likelihood:                                 -3091.3568
Number of Samples:                          350 AIC:                                             6203.4401
                                                AICc:                                            6204.1356
                                                GCV:                                                0.0463
                                                Scale:                                              0.0441
                                                Pseudo R-Squared:                                   0.8527
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            3.8          8.00e-04     ***         
s(1)                              [0.6]                6            2.8          1.11e-16     ***         
s(2)                              [0.6]                6            2.7          1.11e-16     ***         
intercept                                              1            0.0          1.11e-16     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/3553637546.py:9: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>cmap<span class="op">=</span> cmaps.colorblind_10</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span>[cmap(<span class="dv">0</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">2</span>)]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose `gam` is your model and `gam.terms` contains the terms used in the model.</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># First, determine the number of plots (ignoring the intercept)</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="bu">sum</span>(<span class="kw">not</span> term.isintercept <span class="cf">for</span> term <span class="kw">in</span> gam.terms)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the figure</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store y-limits</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>y_limits <span class="op">=</span> []</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> X.columns</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># First pass: compute the y-axis limits for all plots</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    y_limits.append((<span class="bu">min</span>(pdep.<span class="bu">min</span>(), confi.<span class="bu">min</span>()), <span class="bu">max</span>(pdep.<span class="bu">max</span>(), confi.<span class="bu">max</span>())))</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Global y limits</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>global_y_min <span class="op">=</span> <span class="bu">min</span>(limit[<span class="dv">0</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>global_y_max <span class="op">=</span> <span class="bu">max</span>(limit[<span class="dv">1</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Second pass: plot with standardized y limits</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the subplot position</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">1</span>, plot_count, current_plot)</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], pdep,c<span class="op">=</span>colors[i])</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], confi, c<span class="op">=</span>colors[i], ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(XX[:, term.feature], confi[:, <span class="dv">0</span>], confi[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_y_min, global_y_max)  <span class="co"># Set global y limits</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.title(labels[i])</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(labels[i])  <span class="co"># Remove x-axis label</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.ylabel('')  # Remove y-axis label</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(<span class="st">'Partial Dependence'</span>)</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>    current_plot <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Move to the next plot position</span></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust subplots to fit into figure area.</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>plt.show()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bayes-agent-results" class="level1">
<h1>Bayes-agent-results</h1>
<div id="cell-36" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="op">=</span> pd.read_csv(<span class="st">'bayesagent_results_df.csv'</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dill</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-37" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_df[<span class="st">'converged'</span>] <span class="op">=</span> data_df[<span class="st">'convergence_step'</span>]<span class="op">&lt;</span> <span class="dv">10000</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'N. unconverged simulations: '</span>, np.<span class="bu">sum</span>(<span class="op">~</span> data_df[<span class="st">'converged'</span>]))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>data_df[<span class="st">'share_of_correct_agents_at_conv'</span>] <span class="op">=</span> data_df[<span class="st">'true_consensus'</span>]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>data_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>N. unconverged simulations:  155</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">n_agents</th>
<th data-quarto-table-cell-role="th">ba_degree</th>
<th data-quarto-table-cell-role="th">er_prob</th>
<th data-quarto-table-cell-role="th">p_rewiring</th>
<th data-quarto-table-cell-role="th">uncertainty</th>
<th data-quarto-table-cell-role="th">n_experiments</th>
<th data-quarto-table-cell-role="th">rewiring_type</th>
<th data-quarto-table-cell-role="th">mean_degree</th>
<th data-quarto-table-cell-role="th">network_type</th>
<th data-quarto-table-cell-role="th">true_consensus</th>
<th data-quarto-table-cell-role="th">convergence_step</th>
<th data-quarto-table-cell-role="th">agent_type</th>
<th data-quarto-table-cell-role="th">converged</th>
<th data-quarto-table-cell-role="th">share_of_correct_agents_at_conv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>50</td>
<td>3</td>
<td>0.001581</td>
<td>0.314585</td>
<td>0.009161</td>
<td>88</td>
<td>randomize</td>
<td>5.480000</td>
<td>ba</td>
<td>1.000000</td>
<td>123</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>115</td>
<td>6</td>
<td>0.104298</td>
<td>0.934059</td>
<td>0.002747</td>
<td>94</td>
<td>randomize</td>
<td>10.973913</td>
<td>ba</td>
<td>1.000000</td>
<td>574</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>76</td>
<td>5</td>
<td>0.223489</td>
<td>0.998311</td>
<td>0.002316</td>
<td>35</td>
<td>randomize</td>
<td>9.052632</td>
<td>ba</td>
<td>1.000000</td>
<td>1873</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>58</td>
<td>3</td>
<td>0.203830</td>
<td>0.041382</td>
<td>0.009668</td>
<td>70</td>
<td>randomize</td>
<td>5.689655</td>
<td>ba</td>
<td>1.000000</td>
<td>129</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>132</td>
<td>2</td>
<td>0.144579</td>
<td>0.650044</td>
<td>0.003101</td>
<td>31</td>
<td>randomize</td>
<td>3.909091</td>
<td>ba</td>
<td>0.977273</td>
<td>3863</td>
<td>bayes</td>
<td>True</td>
<td>0.977273</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2995</td>
<td>65</td>
<td>8</td>
<td>0.166648</td>
<td>0.831336</td>
<td>0.001522</td>
<td>61</td>
<td>randomize</td>
<td>8.000000</td>
<td>ws</td>
<td>1.000000</td>
<td>2666</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2996</td>
<td>22</td>
<td>8</td>
<td>0.236724</td>
<td>0.631580</td>
<td>0.004028</td>
<td>30</td>
<td>randomize</td>
<td>8.000000</td>
<td>ws</td>
<td>1.000000</td>
<td>400</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2997</td>
<td>145</td>
<td>4</td>
<td>0.160007</td>
<td>0.177034</td>
<td>0.009306</td>
<td>61</td>
<td>randomize</td>
<td>4.000000</td>
<td>ws</td>
<td>1.000000</td>
<td>167</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2998</td>
<td>104</td>
<td>3</td>
<td>0.182446</td>
<td>0.119717</td>
<td>0.001778</td>
<td>16</td>
<td>randomize</td>
<td>2.000000</td>
<td>ws</td>
<td>0.903846</td>
<td>10000</td>
<td>bayes</td>
<td>False</td>
<td>0.903846</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2999</td>
<td>138</td>
<td>10</td>
<td>0.195269</td>
<td>0.049671</td>
<td>0.004923</td>
<td>54</td>
<td>randomize</td>
<td>10.000000</td>
<td>ws</td>
<td>1.000000</td>
<td>398</td>
<td>bayes</td>
<td>True</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

<p>3000 rows × 14 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data_df[<span class="st">'convergence_step'</span>])</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">#"true_consensus", "choice_consensus" and "convergence_step"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'uncertainty'</span>], data_df[<span class="st">'convergence_step'</span>], c<span class="op">=</span><span class="st">'#1a2340'</span>,alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Uncertainty'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Convergence Step'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs Convergence-Step'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="barabasi-albert-graph" class="level3">
<h3 class="anchored" data-anchor-id="barabasi-albert-graph">Barabasi-Albert-graph</h3>
<div id="cell-43" class="cell" data-execution_count="235">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_df[[<span class="st">'p_rewiring'</span>,  <span class="st">'uncertainty'</span>,  <span class="st">'n_experiments'</span>, <span class="st">'mean_degree'</span>]][data_df[<span class="st">'network_type'</span>]<span class="op">==</span><span class="st">'ba'</span>]</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_df[<span class="st">'share_of_correct_agents_at_conv'</span>][data_df[<span class="st">'network_type'</span>]<span class="op">==</span><span class="st">'ba'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-44" class="cell" data-execution_count="236">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_agents'</span>: <span class="st">'Number of Agents'</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p_rewiring'</span>: <span class="st">'Probability of Rewiring'</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'uncertainty'</span>: <span class="st">'Uncertainty Level'</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_experiments'</span>: <span class="st">'Number of Experiments'</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'share_of_correct_agents_at_conv'</span>: <span class="st">'Share of correct agents'</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mean_degree'</span>: <span class="st">'Mean Degree'</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns in X for better readability</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>X.rename(columns<span class="op">=</span>rename_dict, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-execution_count="237">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[col], y, c<span class="op">=</span><span class="st">'#1a2340'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(rename_dict.get(col, col))  <span class="co"># Use renamed label</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(rename_dict[<span class="st">'share_of_correct_agents_at_conv'</span>])</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    axes[i].set_title(<span class="ss">f'</span><span class="sc">{</span>rename_dict<span class="sc">.</span>get(col, col)<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="223">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gam.__dict__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="223">
<pre><code>{'scale': None,
 'max_iter': 100,
 'tol': 0.0001,
 'distribution': NormalDist(),
 'link': IdentityLink(),
 'callbacks': [Deviance(), Diffs()],
 'verbose': False,
 'terms': s(0) + s(1) + s(2) + intercept,
 'fit_intercept': True,
 '_constraint_lam': 1000000000.0,
 '_constraint_l2': 0.001,
 '_constraint_l2_max': 0.1,
 '_term_location': 'terms',
 '_name': None,
 '_line_width': 70,
 '_line_offset': 3,
 '_exclude': ['distribution', 'link'],
 '_include': [],
 'logs_': defaultdict(list,
             {'deviance': [1925.784076306614, 17.485577013928935],
              'diffs': [0.9999999389640168, 4.3900432592352055e-17]}),
 'statistics_': {'n_samples': 2100,
  'm_features': 3,
  'edof_per_coef': array([9.32839394e-01, 7.46711538e-01, 7.76090854e-01, 8.78840972e-01,
         8.96424918e-01, 2.77763937e-01, 9.17840644e-01, 7.30178786e-01,
         7.61918976e-01, 8.32730825e-01, 2.76252445e-01, 1.22137803e-03,
         9.14375374e-01, 7.36561104e-01, 7.57913731e-01, 8.28641633e-01,
         2.78946921e-01, 3.63339315e-21, 2.26801516e-21]),
  'edof': 11.545253430279555,
  'scale': 0.008372495043356305,
  'cov': array([[ 1.36700628e-03, -2.98162934e-04, -2.48310237e-04,
          -1.53209634e-04, -2.54871505e-04, -2.42088418e-04,
           5.44258856e-05,  1.74654961e-05,  2.02264827e-05,
           1.28601308e-05,  1.63140179e-05,  4.90721830e-05,
           5.42336638e-05,  1.51638448e-05,  1.43788462e-05,
           1.54697675e-05,  1.32642111e-05,  5.78534010e-05,
           1.70363489e-04],
         [-2.98162934e-04,  1.95320279e-04,  6.79496180e-05,
           1.10281260e-04,  1.20427672e-04, -2.54471021e-04,
           1.86469305e-05, -2.39177339e-05, -2.11753912e-05,
          -2.16638141e-05, -2.51333681e-05,  1.45880668e-05,
           1.59046462e-05, -2.41167678e-05, -2.10992585e-05,
          -2.06663616e-05, -2.42431244e-05,  1.55656554e-05,
          -5.86550771e-05],
         [-2.48310237e-04,  6.79496180e-05,  1.27937042e-04,
           5.19909458e-05,  1.06750637e-04, -1.51661120e-04,
           1.93353390e-05, -2.10327070e-05, -1.78855916e-05,
          -1.68270495e-05, -2.04006104e-05,  1.14675499e-05,
           1.44508697e-05, -1.95760666e-05, -1.79486505e-05,
          -1.67156710e-05, -2.03148969e-05,  1.47612999e-05,
          -4.53430214e-05],
         [-1.53209634e-04,  1.10281260e-04,  5.19909458e-05,
           1.31294727e-04,  6.74065046e-05, -2.51648615e-04,
           2.39875274e-05, -1.95972309e-05, -1.89601478e-05,
          -1.74453207e-05, -2.24584508e-05,  1.05887070e-05,
           2.62904522e-05, -2.13646762e-05, -2.29446896e-05,
          -1.88913540e-05, -2.18279729e-05,  1.48533723e-05,
          -4.38847979e-05],
         [-2.54871505e-04,  1.20427672e-04,  1.06750637e-04,
           6.74065046e-05,  1.89647064e-04, -2.86269303e-04,
           2.16062653e-05, -2.49491733e-05, -2.23347007e-05,
          -2.05876324e-05, -2.31186571e-05,  1.24749946e-05,
           1.24351352e-05, -2.27982768e-05, -2.07798757e-05,
          -2.15615909e-05, -2.33837633e-05,  1.91794186e-05,
          -5.69087976e-05],
         [-2.42088418e-04, -2.54471021e-04, -1.51661120e-04,
          -2.51648615e-04, -2.86269303e-04,  1.35250761e-03,
           3.29504564e-05,  1.32654199e-05,  1.59580806e-05,
           1.96547253e-05,  1.64274031e-05,  6.81128704e-05,
           4.70900920e-05,  1.34513352e-05,  2.42596992e-05,
           1.66158640e-05,  1.73982065e-05,  4.75539473e-05,
           1.66368869e-04],
         [ 5.44258856e-05,  1.86469305e-05,  1.93353390e-05,
           2.39875274e-05,  2.16062653e-05,  3.29504564e-05,
           1.37677360e-03, -2.95693282e-04, -2.53203671e-04,
          -1.58275793e-04, -2.57710818e-04, -2.40936558e-04,
           6.59099968e-05,  1.20425088e-05,  1.46460409e-05,
           1.63516237e-05,  9.84165193e-06,  5.21606290e-05,
           1.70952410e-04],
         [ 1.74654961e-05, -2.39177339e-05, -2.10327070e-05,
          -1.95972309e-05, -2.49491733e-05,  1.32654199e-05,
          -2.95693282e-04,  1.91456360e-04,  6.64659159e-05,
           1.07240624e-04,  1.21091160e-04, -2.49327177e-04,
           1.46251027e-05, -2.18477341e-05, -2.02918957e-05,
          -1.89162372e-05, -2.40457375e-05,  1.17105551e-05,
          -5.87659436e-05],
         [ 2.02264827e-05, -2.11753912e-05, -1.78855916e-05,
          -1.89601478e-05, -2.23347007e-05,  1.59580806e-05,
          -2.53203671e-04,  6.64659159e-05,  1.30938387e-04,
           5.20882698e-05,  1.09591723e-04, -1.50052086e-04,
           1.80527183e-05, -1.98111181e-05, -2.08319148e-05,
          -1.79730324e-05, -2.18314072e-05,  1.82234798e-05,
          -4.41712757e-05],
         [ 1.28601308e-05, -2.16638141e-05, -1.68270495e-05,
          -1.74453207e-05, -2.05876324e-05,  1.96547253e-05,
          -1.58275793e-04,  1.07240624e-04,  5.20882698e-05,
           1.27041164e-04,  6.84740731e-05, -2.40577558e-04,
           2.52063674e-05, -1.86144943e-05, -2.09272805e-05,
          -1.69614365e-05, -2.35829622e-05,  1.08708382e-05,
          -4.40089716e-05],
         [ 1.63140179e-05, -2.51333681e-05, -2.04006104e-05,
          -2.24584508e-05, -2.31186571e-05,  1.64274031e-05,
          -2.57710818e-04,  1.21091160e-04,  1.09591723e-04,
           6.84740731e-05,  1.95898676e-04, -2.95714834e-04,
           1.17455877e-05, -2.39459129e-05, -2.14483855e-05,
          -2.15623362e-05, -2.51711044e-05,  2.20124709e-05,
          -5.83696755e-05],
         [ 4.90721830e-05,  1.45880668e-05,  1.14675499e-05,
           1.05887070e-05,  1.24749946e-05,  6.81128704e-05,
          -2.40936558e-04, -2.49327177e-04, -1.50052086e-04,
          -2.40577558e-04, -2.95714834e-04,  1.34291304e-03,
           3.48651743e-05,  1.29361794e-05,  2.47195536e-05,
           1.33121102e-05,  2.56822742e-05,  5.47891124e-05,
           1.66304376e-04],
         [ 5.42336638e-05,  1.59046462e-05,  1.44508697e-05,
           2.62904522e-05,  1.24351352e-05,  4.70900920e-05,
           6.59099968e-05,  1.46251027e-05,  1.80527183e-05,
           2.52063674e-05,  1.17455877e-05,  3.48651743e-05,
           1.38178442e-03, -2.90314404e-04, -2.56897224e-04,
          -1.59595546e-04, -2.59367927e-04, -2.45204648e-04,
           1.70404839e-04],
         [ 1.51638448e-05, -2.41167678e-05, -1.95760666e-05,
          -2.13646762e-05, -2.27982768e-05,  1.34513352e-05,
           1.20425088e-05, -2.18477341e-05, -1.98111181e-05,
          -1.86144943e-05, -2.39459129e-05,  1.29361794e-05,
          -2.90314404e-04,  1.93187884e-04,  6.57415353e-05,
           1.07096734e-04,  1.20671795e-04, -2.55624103e-04,
          -5.92406218e-05],
         [ 1.43788462e-05, -2.10992585e-05, -1.79486505e-05,
          -2.29446896e-05, -2.07798757e-05,  2.42596992e-05,
           1.46460409e-05, -2.02918957e-05, -2.08319148e-05,
          -2.09272805e-05, -2.14483855e-05,  2.47195536e-05,
          -2.56897224e-04,  6.57415353e-05,  1.34285001e-04,
           5.39558929e-05,  1.11658931e-04, -1.52878080e-04,
          -4.41339479e-05],
         [ 1.54697675e-05, -2.06663616e-05, -1.67156710e-05,
          -1.88913540e-05, -2.15615909e-05,  1.66158640e-05,
           1.63516237e-05, -1.89162372e-05, -1.79730324e-05,
          -1.69614365e-05, -2.15623362e-05,  1.33121102e-05,
          -1.59595546e-04,  1.07096734e-04,  5.39558929e-05,
           1.26501305e-04,  6.86650648e-05, -2.42372765e-04,
          -4.57493569e-05],
         [ 1.32642111e-05, -2.42431244e-05, -2.03148969e-05,
          -2.18279729e-05, -2.33837633e-05,  1.73982065e-05,
           9.84165193e-06, -2.40457375e-05, -2.18314072e-05,
          -2.35829622e-05, -2.51711044e-05,  2.56822742e-05,
          -2.59367927e-04,  1.20671795e-04,  1.11658931e-04,
           6.86650648e-05,  1.96758530e-04, -2.97493764e-04,
          -5.91073705e-05],
         [ 5.78534010e-05,  1.55656554e-05,  1.47612999e-05,
           1.48533723e-05,  1.91794186e-05,  4.75539473e-05,
           5.21606290e-05,  1.17105551e-05,  1.82234798e-05,
           1.08708382e-05,  2.20124709e-05,  5.47891124e-05,
          -2.45204648e-04, -2.55624103e-04, -1.52878080e-04,
          -2.42372765e-04, -2.97493764e-04,  1.36334065e-03,
           1.69767156e-04],
         [ 1.70363489e-04, -5.86550771e-05, -4.53430214e-05,
          -4.38847979e-05, -5.69087976e-05,  1.66368869e-04,
           1.70952410e-04, -5.87659436e-05, -4.41712757e-05,
          -4.40089716e-05, -5.83696755e-05,  1.66304376e-04,
           1.70404839e-04, -5.92406218e-05, -4.41339479e-05,
          -4.57493569e-05, -5.91073705e-05,  1.69767156e-04,
           1.31940631e-04]]),
  'se': array([0.03697305, 0.0139757 , 0.01131093, 0.01145839, 0.01377124,
         0.03677645, 0.0371049 , 0.01383678, 0.01144283, 0.01127125,
         0.01399638, 0.03664578, 0.03717236, 0.0138992 , 0.01158814,
         0.01124728, 0.01402706, 0.03692344, 0.01148654]),
  'AIC': 233239.19725887125,
  'AICc': 233239.3601463121,
  'pseudo_r2': OrderedDict([('explained_deviance', 0.024613582988729288),
               ('McFadden', 0.9737186908494713),
               ('McFadden_adj', 0.02618490135417184)]),
  'GCV': 0.008456135258598625,
  'UBRE': None,
  'loglikelihood': -116607.05337600535,
  'deviance': 2088.4547465697215,
  'p_values': [0.04047720917482878,
   4.235756300485782e-06,
   0.23543813939881653,
   1.1102230246251565e-16]},
 'coef_': array([ 0.05980248,  0.11005425,  0.10036804,  0.10512048,  0.13050802,
         0.10813483, -0.03510071,  0.09103263,  0.133622  ,  0.11257983,
         0.12104685,  0.19080746,  0.05362659,  0.1038163 ,  0.11785579,
         0.11977037,  0.11691145,  0.10200771,  0.61398822])}</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LinearGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">3</span>,n_splines<span class="op">=</span><span class="dv">6</span>) ).fit(X_train, y_train)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on training data: {gam.accuracy(X_train, y_train)}")</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on test data: {gam.accuracy(X_test, y_test)}")</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinearGAM                                                                                                 
=============================================== ==========================================================
Distribution:                        NormalDist Effective DoF:                                     14.9103
Link Function:                     IdentityLink Log Likelihood:                               -140419.6615
Number of Samples:                         2100 AIC:                                           280871.1437
                                                AICc:                                          280871.4021
                                                GCV:                                                0.0071
                                                Scale:                                               0.007
                                                Pseudo R-Squared:                                   0.1857
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            4.5          1.21e-01                 
s(1)                              [0.6]                6            3.5          1.81e-07     ***         
s(2)                              [0.6]                6            3.5          4.49e-02     *           
s(3)                              [0.6]                6            3.4          1.11e-16     ***         
intercept                                              1            0.0          1.11e-16     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_46130/3638153939.py:9: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>cmap<span class="op">=</span> cmaps.colorblind_10</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span>[cmap(<span class="dv">0</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">2</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">3</span>)]</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose `gam` is your model and `gam.terms` contains the terms used in the model.</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># First, determine the number of plots (ignoring the intercept)</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="bu">sum</span>(<span class="kw">not</span> term.isintercept <span class="cf">for</span> term <span class="kw">in</span> gam.terms)</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the figure</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">4</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store y-limits</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>y_limits <span class="op">=</span> []</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> X.columns</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co"># First pass: compute the y-axis limits for all plots</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>    y_limits.append((<span class="bu">min</span>(pdep.<span class="bu">min</span>(), confi.<span class="bu">min</span>()), <span class="bu">max</span>(pdep.<span class="bu">max</span>(), confi.<span class="bu">max</span>())))</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Global y limits</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>global_y_min <span class="op">=</span> <span class="bu">min</span>(limit[<span class="dv">0</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>global_y_max <span class="op">=</span> <span class="bu">max</span>(limit[<span class="dv">1</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Second pass: plot with standardized y limits</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the subplot position</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">1</span>, plot_count, current_plot)</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], pdep,c<span class="op">=</span>colors[i])</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], confi, c<span class="op">=</span>colors[i], ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(XX[:, term.feature], confi[:, <span class="dv">0</span>], confi[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_y_min, global_y_max)  <span class="co"># Set global y limits</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.title(labels[i])</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(labels[i])  <span class="co"># Remove x-axis label</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.ylabel('')  # Remove y-axis label</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(<span class="st">'Partial Dependence'</span>)</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>    current_plot <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Move to the next plot position</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust subplots to fit into figure area.</span></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>plt.show()  </span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="watts-strogatz" class="level3">
<h3 class="anchored" data-anchor-id="watts-strogatz">Watts-Strogatz</h3>
<div id="cell-51" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_df[[<span class="st">'mean_degree'</span>,<span class="st">'ba_degree'</span>, <span class="st">'p_rewiring'</span>, <span class="st">'uncertainty'</span>, <span class="st">'n_experiments'</span>, ]][data_df[<span class="st">'network_type'</span>]<span class="op">==</span><span class="st">'ws'</span>]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_df[<span class="st">'share_of_correct_agents_at_conv'</span>][data_df[<span class="st">'network_type'</span>]<span class="op">==</span><span class="st">'ws'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-52" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_agents'</span>: <span class="st">'Number of Agents'</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p_rewiring'</span>: <span class="st">'Probability of Rewiring'</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'uncertainty'</span>: <span class="st">'Uncertainty Level'</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_experiments'</span>: <span class="st">'Number of Experiments'</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'share_of_correct_agents_at_conv'</span>: <span class="st">'Share of correct agents'</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mean_degree'</span>: <span class="st">'Mean Degree'</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ba_degree'</span> : <span class="st">'WS-neighbors'</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns in X for better readability</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>X.rename(columns<span class="op">=</span>rename_dict, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-53" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">2</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[col], y, c<span class="op">=</span><span class="st">'#1a2340'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(rename_dict.get(col, col))  <span class="co"># Use renamed label</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(rename_dict[<span class="st">'share_of_correct_agents_at_conv'</span>])</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_title(f'{rename_dict.get(col, col)}')</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LinearGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">3</span>,n_splines<span class="op">=</span><span class="dv">6</span>)<span class="op">+</span> s(<span class="dv">4</span>,n_splines<span class="op">=</span><span class="dv">6</span>),</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                max_iter<span class="op">=</span><span class="dv">10000</span>,tol<span class="op">=</span><span class="fl">0.00001</span>,verbose<span class="op">=</span><span class="va">True</span>).fit(X_train, y_train)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">#gam.gridsearch(X_train, y_train)</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on training data: {gam.accuracy(X_train, y_train)}")</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on test data: {gam.accuracy(X_test, y_test)}")</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinearGAM                                                                                                 
=============================================== ==========================================================
Distribution:                        NormalDist Effective DoF:                                     15.7391
Link Function:                     IdentityLink Log Likelihood:                               -667491.2935
Number of Samples:                          700 AIC:                                          1335016.0653
                                                AICc:                                         1335016.9357
                                                GCV:                                                0.0005
                                                Scale:                                              0.0005
                                                Pseudo R-Squared:                                   0.1404
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            4.2          2.19e-02     *           
s(1)                              [0.6]                6            2.4          6.47e-01                 
s(2)                              [0.6]                6            3.1          2.45e-01                 
s(3)                              [0.6]                6            3.0          1.11e-16     ***         
s(4)                              [0.6]                6            3.0          5.31e-01                 
intercept                                              1            0.0          1.11e-16     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages/pygam/utils.py:78: UserWarning: Could not import Scikit-Sparse or Suite-Sparse.
This will slow down optimization for models with monotonicity/convexity penalties and many splines.
See installation instructions for installing Scikit-Sparse and Suite-Sparse via Conda.
  warnings.warn(msg)
/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/4168073109.py:10: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>cmap<span class="op">=</span> cmaps.colorblind_10</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span>[cmap(<span class="dv">0</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">2</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">3</span>)]</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose `gam` is your model and `gam.terms` contains the terms used in the model.</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co"># First, determine the number of plots (ignoring the intercept)</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="bu">sum</span>(<span class="kw">not</span> term.isintercept <span class="cf">for</span> term <span class="kw">in</span> gam.terms)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the figure</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">5</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store y-limits</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>y_limits <span class="op">=</span> []</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> X.columns</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co"># First pass: compute the y-axis limits for all plots</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>    y_limits.append((<span class="bu">min</span>(pdep.<span class="bu">min</span>(), confi.<span class="bu">min</span>()), <span class="bu">max</span>(pdep.<span class="bu">max</span>(), confi.<span class="bu">max</span>())))</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Global y limits</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>global_y_min <span class="op">=</span> <span class="bu">min</span>(limit[<span class="dv">0</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>global_y_max <span class="op">=</span> <span class="bu">max</span>(limit[<span class="dv">1</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Second pass: plot with standardized y limits</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.99</span>)</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the subplot position</span></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">1</span>, plot_count, current_plot)</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], pdep,c<span class="op">=</span>colors[i])</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], confi, c<span class="op">=</span>colors[i], ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(XX[:, term.feature], confi[:, <span class="dv">0</span>], confi[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_y_min, global_y_max)  <span class="co"># Set global y limits</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.title(labels[i])</span></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(labels[i])  <span class="co"># Remove x-axis label</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.ylabel('')  # Remove y-axis label</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(<span class="st">'Partial Dependence'</span>)</span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>    current_plot <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Move to the next plot position</span></span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust subplots to fit into figure area.</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>plt.show()  </span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: list index out of range</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-49-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="beta-agents-perceptron" class="level1">
<h1>Beta-Agents: Perceptron</h1>
<div id="cell-62" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="op">=</span> pd.read_csv(<span class="st">'betaagent_perceptron_results_df.csv'</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> dill</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>data_df[<span class="st">'converged'</span>] <span class="op">=</span> data_df[<span class="st">'convergence_step'</span>]<span class="op">&lt;</span> <span class="dv">10000</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'N. unconverged simulations: '</span>, np.<span class="bu">sum</span>(<span class="op">~</span> data_df[<span class="st">'converged'</span>]))</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>data_df[<span class="st">'share_of_correct_agents_at_conv'</span>] <span class="op">=</span> data_df[<span class="st">'true_consensus'</span>]</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>data_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>N. unconverged simulations:  0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="95">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">n_agents</th>
<th data-quarto-table-cell-role="th">p_rewiring</th>
<th data-quarto-table-cell-role="th">uncertainty</th>
<th data-quarto-table-cell-role="th">n_experiments</th>
<th data-quarto-table-cell-role="th">rewiring_type</th>
<th data-quarto-table-cell-role="th">mean_degree</th>
<th data-quarto-table-cell-role="th">true_consensus</th>
<th data-quarto-table-cell-role="th">convergence_step</th>
<th data-quarto-table-cell-role="th">agent_type</th>
<th data-quarto-table-cell-role="th">converged</th>
<th data-quarto-table-cell-role="th">share_of_correct_agents_at_conv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3519</td>
<td>0.167128</td>
<td>0.016293</td>
<td>7823</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.641091</td>
<td>13</td>
<td>beta</td>
<td>True</td>
<td>0.641091</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3519</td>
<td>0.336735</td>
<td>0.001628</td>
<td>5232</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.417164</td>
<td>40</td>
<td>beta</td>
<td>True</td>
<td>0.417164</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3519</td>
<td>0.792060</td>
<td>0.020601</td>
<td>8277</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.896562</td>
<td>11</td>
<td>beta</td>
<td>True</td>
<td>0.896562</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3519</td>
<td>0.617836</td>
<td>0.024003</td>
<td>2308</td>
<td>randomize</td>
<td>4.344984</td>
<td>0.852231</td>
<td>22</td>
<td>beta</td>
<td>True</td>
<td>0.852231</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3519</td>
<td>0.312612</td>
<td>0.008055</td>
<td>6000</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.679170</td>
<td>16</td>
<td>beta</td>
<td>True</td>
<td>0.679170</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">495</td>
<td>3519</td>
<td>0.674205</td>
<td>0.013683</td>
<td>5655</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.869849</td>
<td>15</td>
<td>beta</td>
<td>True</td>
<td>0.869849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">496</td>
<td>3519</td>
<td>0.154921</td>
<td>0.017435</td>
<td>2927</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.622052</td>
<td>22</td>
<td>beta</td>
<td>True</td>
<td>0.622052</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">497</td>
<td>3519</td>
<td>0.827781</td>
<td>0.007085</td>
<td>2415</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.862177</td>
<td>22</td>
<td>beta</td>
<td>True</td>
<td>0.862177</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">498</td>
<td>3519</td>
<td>0.608561</td>
<td>0.007434</td>
<td>4547</td>
<td>randomize</td>
<td>4.346121</td>
<td>0.805058</td>
<td>16</td>
<td>beta</td>
<td>True</td>
<td>0.805058</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">499</td>
<td>3519</td>
<td>0.972876</td>
<td>0.024025</td>
<td>6550</td>
<td>randomize</td>
<td>4.346689</td>
<td>0.926684</td>
<td>12</td>
<td>beta</td>
<td>True</td>
<td>0.926684</td>
</tr>
</tbody>
</table>

<p>500 rows × 11 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_df[[<span class="st">'p_rewiring'</span>,  <span class="st">'uncertainty'</span>,  <span class="st">'n_experiments'</span> ]]</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_df[<span class="st">'share_of_correct_agents_at_conv'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-64" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_agents'</span>: <span class="st">'Number of Agents'</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p_rewiring'</span>: <span class="st">'Probability of Rewiring'</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'uncertainty'</span>: <span class="st">'Uncertainty (lower = harder)'</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_experiments'</span>: <span class="st">'Number of Experiments'</span>,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'share_of_correct_agents_at_conv'</span>: <span class="st">'Share of correct agents'</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns in X for better readability</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>X.rename(columns<span class="op">=</span>rename_dict, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[col], y, c<span class="op">=</span><span class="st">'#1a2340'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(rename_dict.get(col, col))  <span class="co"># Use renamed label</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(rename_dict[<span class="st">'share_of_correct_agents_at_conv'</span>])</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_title(f'{rename_dict.get(col, col)}')</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    plt.gca().set_yticks([])</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    plt.gca().set_yticklabels([])</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>plt.savefig(output_dir <span class="op">+</span> <span class="ss">f"perceptron_graph_randomized_pred_share_conv_data.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>, transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/1446775079.py:10: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  X.rename(columns=rename_dict, inplace=True)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-56-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="predicting-convergence-steps-1" class="level2">
<h2 class="anchored" data-anchor-id="predicting-convergence-steps-1">predicting convergence steps</h2>
<div id="cell-66" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_df[[<span class="st">'p_rewiring'</span>,  <span class="st">'uncertainty'</span>,  <span class="st">'n_experiments'</span> ]]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.log(data_df[<span class="st">'convergence_step'</span>])</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>rename_dict <span class="op">=</span> {</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_agents'</span>: <span class="st">'Number of Agents'</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'p_rewiring'</span>: <span class="st">'Probability of Rewiring'</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'uncertainty'</span>: <span class="st">'Uncertainty (lower = harder)'</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_experiments'</span>: <span class="st">'Number of Experiments'</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'convergence_step'</span>: <span class="st">'Steps until convergence (log)'</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming columns in X for better readability</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>X.rename(columns<span class="op">=</span>rename_dict, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/2917641511.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  X.rename(columns=rename_dict, inplace=True)</code></pre>
</div>
</div>
<div id="cell-67" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">13</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.ravel()</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, col <span class="kw">in</span> <span class="bu">enumerate</span>(X.columns):</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    axes[i].scatter(X[col], y, c<span class="op">=</span><span class="st">'#1a2340'</span>, alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    axes[i].set_xlabel(rename_dict.get(col, col))  <span class="co"># Use renamed label</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>        axes[i].set_ylabel(rename_dict[<span class="st">'convergence_step'</span>])</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_title(f'{rename_dict.get(col, col)}')</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#axes[i].set_yscale('log')  # Set y-scale to log for each axis</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-68" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LinearGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>) ,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                max_iter<span class="op">=</span><span class="dv">10000</span>,tol<span class="op">=</span><span class="fl">0.00001</span>,verbose<span class="op">=</span><span class="va">True</span>).fit(X_train, y_train)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#gam.gridsearch(X_train, y_train)</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on training data: {gam.accuracy(X_train, y_train)}")</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"Accuracy on test data: {gam.accuracy(X_test, y_test)}")</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinearGAM                                                                                                 
=============================================== ==========================================================
Distribution:                        NormalDist Effective DoF:                                      9.3633
Link Function:                     IdentityLink Log Likelihood:                                 -3091.3568
Number of Samples:                          350 AIC:                                             6203.4401
                                                AICc:                                            6204.1356
                                                GCV:                                                0.0463
                                                Scale:                                              0.0441
                                                Pseudo R-Squared:                                   0.8527
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            3.8          8.00e-04     ***         
s(1)                              [0.6]                6            2.8          1.11e-16     ***         
s(2)                              [0.6]                6            2.7          1.11e-16     ***         
intercept                                              1            0.0          1.11e-16     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages/pygam/utils.py:78: UserWarning: Could not import Scikit-Sparse or Suite-Sparse.
This will slow down optimization for models with monotonicity/convexity penalties and many splines.
See installation instructions for installing Scikit-Sparse and Suite-Sparse via Conda.
  warnings.warn(msg)
/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_3358/256282558.py:10: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-70" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_markdown(data):</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    markdown <span class="op">=</span> []</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add general information</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"## Model Summary Table</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"| | |"</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"|---------------------------------------------|----------------------------------------------------------|"</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **Number of Samples:**                      | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'n_samples'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                       |"</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **Number of Features:**                     | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'m_features'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                    |"</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **Effective DoF:**                          | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'edof'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                    |"</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **Log Likelihood:**                         | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'loglikelihood'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                |"</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **AIC:**                                    | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'AIC'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                 |"</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **AICc:**                                   | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'AICc'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                 |"</span>)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **GCV:**                                    | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'GCV'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                    |"</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **Scale:**                                  | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'scale'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                    |"</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="ss">f"| **Pseudo R-Squared:**                       | </span><span class="sc">{</span>np<span class="sc">.</span><span class="bu">round</span>(data[<span class="st">'pseudo_r2'</span>][<span class="st">'explained_deviance'</span>],<span class="dv">3</span>)<span class="sc">}</span><span class="ss">                                                    |"</span>)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add significance codes</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"</span><span class="ch">\n</span><span class="st">### Significance Codes</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"| Feature Function | SE | P &gt; x | Sig. Code |</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"|------------------|--------|------|-------|-----------|</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (edof, se, p_value) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(data[<span class="st">'edof_per_coef'</span>], data[<span class="st">'se'</span>], data[<span class="st">'p_values'</span>])):</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        sig_code <span class="op">=</span> <span class="st">''</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.001</span>:</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>            sig_code <span class="op">=</span> <span class="st">'***'</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> p_value <span class="op">&lt;</span> <span class="fl">0.01</span>:</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>            sig_code <span class="op">=</span> <span class="st">'**'</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>            sig_code <span class="op">=</span> <span class="st">'*'</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> p_value <span class="op">&lt;</span> <span class="fl">0.1</span>:</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>            sig_code <span class="op">=</span> <span class="st">'.'</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>        markdown.append(<span class="ss">f"| **s(</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">)**         | </span><span class="sc">{</span>se<span class="sc">:.6f}</span><span class="ss">  | </span><span class="sc">{</span>edof<span class="sc">:.6f}</span><span class="ss">  | </span><span class="sc">{</span>p_value<span class="sc">:.6f}</span><span class="ss">  | </span><span class="sc">{</span>sig_code<span class="sc">}</span><span class="ss"> |</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>    markdown.append(<span class="st">"</span><span class="ch">\n</span><span class="st">*Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1*"</span>)</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(markdown)</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_markdown(gam.__dict__[<span class="st">'statistics_'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Model Summary Table

| | |
|---------------------------------------------|----------------------------------------------------------|
| **Number of Samples:**                      | 350                                                       |
| **Number of Features:**                     | 3                                                    |
| **Effective DoF:**                          | 9.363259475973033                                                    |
| **Log Likelihood:**                         | -3091.356797013329                                                |
| **AIC:**                                    | 6203.440112978604                                                 |
| **AICc:**                                   | 6204.1356099070235                                                 |
| **GCV:**                                    | 0.046324143594586586                                                    |
| **Scale:**                                  | 0.04409890546368969                                                    |
| **Pseudo R-Squared:**                       | OrderedDict({'explained_deviance': 0.852726931249906, 'McFadden': 0.12144945256629064, 'McFadden_adj': 0.8781826951241049})                                                    |

### Significance Codes

| Feature Function | SE | P &gt; x | Sig. Code |

|------------------|--------|------|-------|-----------|

| **s(0)**         | 0.098748  | 0.872848  | 0.000800  | *** |

| **s(1)**         | 0.029018  | 0.654016  | 0.000000  | *** |

| **s(2)**         | 0.043616  | 0.644693  | 0.000000  | *** |

| **s(3)**         | 0.043630  | 0.770473  | 0.000000  | *** |


*Significance codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1*</code></pre>
</div>
</div>
<div id="cell-79" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'n_experiments'</span>], data_df[<span class="st">'convergence_step'</span>], c<span class="op">=</span><span class="st">'#1a2340'</span>,alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'N-Experiments'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Convergence Step'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs N-Experiments'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-70-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-81" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'p_rewiring'</span>], data_df[<span class="st">'share_correct_at_convergence'</span>], c<span class="op">=</span>pd.factorize(data_df[<span class="st">'rewiring_type'</span>])[<span class="dv">0</span>],alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'p-rewiring'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Consensus'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs N-Experiments'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-72-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-82" class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'p_rewiring'</span>], data_df[<span class="st">'true_consensus'</span>], c<span class="op">=</span>pd.factorize(data_df[<span class="st">'rewiring_type'</span>])[<span class="dv">0</span>],alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'p-rewiring'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Consensus'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs N-Experiments'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="beta-agent" class="level1">
<h1>Beta-Agent</h1>
<div id="cell-86" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="op">=</span> pd.read_csv(<span class="st">'betaagent_results_df.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-87" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'n_experiments'</span>], data_df[<span class="st">'convergence_step'</span>], c<span class="op">=</span><span class="st">'#1a2340'</span>,alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'N-Experiments'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Convergence Step'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs N-Experiments (Beta)'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-77-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-88" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'n_experiments'</span>], data_df[<span class="st">'true_consensus'</span>], c<span class="op">=</span><span class="st">'#1a2340'</span>,alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'N-Experiments'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Consensus'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs N-Experiments'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-78-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-89" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pymc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting pymc
  Using cached pymc-5.15.1-py3-none-any.whl.metadata (10 kB)
Collecting arviz&gt;=0.13.0 (from pymc)
  Using cached arviz-0.18.0-py3-none-any.whl.metadata (8.7 kB)
Collecting cachetools&gt;=4.2.1 (from pymc)
  Using cached cachetools-5.3.3-py3-none-any.whl.metadata (5.3 kB)
Requirement already satisfied: cloudpickle in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pymc) (3.0.0)
Requirement already satisfied: numpy&gt;=1.15.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pymc) (1.26.4)
Requirement already satisfied: pandas&gt;=0.24.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pymc) (2.2.2)
Collecting pytensor&lt;2.23,&gt;=2.22.1 (from pymc)
  Using cached pytensor-2.22.1-cp312-cp312-macosx_11_0_arm64.whl
Collecting rich&gt;=13.7.1 (from pymc)
  Using cached rich-13.7.1-py3-none-any.whl.metadata (18 kB)
Requirement already satisfied: scipy&gt;=1.4.1 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pymc) (1.11.4)
Requirement already satisfied: threadpoolctl&lt;4.0.0,&gt;=3.1.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pymc) (3.5.0)
Requirement already satisfied: typing-extensions&gt;=3.7.4 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pymc) (4.11.0)
Requirement already satisfied: setuptools&gt;=60.0.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from arviz&gt;=0.13.0-&gt;pymc) (70.0.0)
Requirement already satisfied: matplotlib&gt;=3.5 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from arviz&gt;=0.13.0-&gt;pymc) (3.8.4)
Requirement already satisfied: packaging in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from arviz&gt;=0.13.0-&gt;pymc) (24.0)
Collecting dm-tree&gt;=0.1.8 (from arviz&gt;=0.13.0-&gt;pymc)
  Using cached dm_tree-0.1.8-cp312-cp312-macosx_11_0_arm64.whl.metadata (1.9 kB)
Requirement already satisfied: xarray&gt;=2022.6.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from arviz&gt;=0.13.0-&gt;pymc) (2024.5.0)
Collecting h5netcdf&gt;=1.0.2 (from arviz&gt;=0.13.0-&gt;pymc)
  Using cached h5netcdf-1.3.0-py3-none-any.whl.metadata (13 kB)
Collecting xarray-einstats&gt;=0.3 (from arviz&gt;=0.13.0-&gt;pymc)
  Using cached xarray_einstats-0.7.0-py3-none-any.whl.metadata (5.8 kB)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pandas&gt;=0.24.0-&gt;pymc) (2.9.0)
Requirement already satisfied: pytz&gt;=2020.1 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pandas&gt;=0.24.0-&gt;pymc) (2024.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pandas&gt;=0.24.0-&gt;pymc) (2024.1)
Requirement already satisfied: filelock in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc) (3.14.0)
Collecting etuples (from pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc)
  Using cached etuples-0.3.9-py3-none-any.whl
Collecting logical-unification (from pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc)
  Using cached logical_unification-0.4.6-py3-none-any.whl
Collecting miniKanren (from pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc)
  Using cached miniKanren-1.0.3-py3-none-any.whl
Collecting cons (from pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc)
  Using cached cons-0.4.6-py3-none-any.whl
Collecting markdown-it-py&gt;=2.2.0 (from rich&gt;=13.7.1-&gt;pymc)
  Using cached markdown_it_py-3.0.0-py3-none-any.whl.metadata (6.9 kB)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from rich&gt;=13.7.1-&gt;pymc) (2.18.0)
Collecting h5py (from h5netcdf&gt;=1.0.2-&gt;arviz&gt;=0.13.0-&gt;pymc)
  Using cached h5py-3.11.0-cp312-cp312-macosx_11_0_arm64.whl.metadata (2.5 kB)
Collecting mdurl~=0.1 (from markdown-it-py&gt;=2.2.0-&gt;rich&gt;=13.7.1-&gt;pymc)
  Using cached mdurl-0.1.2-py3-none-any.whl.metadata (1.6 kB)
Requirement already satisfied: contourpy&gt;=1.0.1 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from matplotlib&gt;=3.5-&gt;arviz&gt;=0.13.0-&gt;pymc) (1.2.1)
Requirement already satisfied: cycler&gt;=0.10 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from matplotlib&gt;=3.5-&gt;arviz&gt;=0.13.0-&gt;pymc) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from matplotlib&gt;=3.5-&gt;arviz&gt;=0.13.0-&gt;pymc) (4.53.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from matplotlib&gt;=3.5-&gt;arviz&gt;=0.13.0-&gt;pymc) (1.4.5)
Requirement already satisfied: pillow&gt;=8 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from matplotlib&gt;=3.5-&gt;arviz&gt;=0.13.0-&gt;pymc) (10.3.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from matplotlib&gt;=3.5-&gt;arviz&gt;=0.13.0-&gt;pymc) (3.1.2)
Requirement already satisfied: six&gt;=1.5 in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=0.24.0-&gt;pymc) (1.16.0)
Requirement already satisfied: toolz in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from logical-unification-&gt;pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc) (0.12.1)
Requirement already satisfied: multipledispatch in /Users/Noich001/miniforge3/envs/network_epist_playground/lib/python3.12/site-packages (from logical-unification-&gt;pytensor&lt;2.23,&gt;=2.22.1-&gt;pymc) (1.0.0)
Using cached pymc-5.15.1-py3-none-any.whl (484 kB)
Using cached arviz-0.18.0-py3-none-any.whl (1.7 MB)
Using cached cachetools-5.3.3-py3-none-any.whl (9.3 kB)
Using cached rich-13.7.1-py3-none-any.whl (240 kB)
Using cached dm_tree-0.1.8-cp312-cp312-macosx_11_0_arm64.whl (111 kB)
Using cached h5netcdf-1.3.0-py3-none-any.whl (43 kB)
Using cached markdown_it_py-3.0.0-py3-none-any.whl (87 kB)
Using cached xarray_einstats-0.7.0-py3-none-any.whl (31 kB)
Using cached mdurl-0.1.2-py3-none-any.whl (10.0 kB)
Using cached h5py-3.11.0-cp312-cp312-macosx_11_0_arm64.whl (2.9 MB)
Installing collected packages: dm-tree, mdurl, logical-unification, h5py, cachetools, markdown-it-py, h5netcdf, cons, rich, etuples, xarray-einstats, miniKanren, pytensor, arviz, pymc
Successfully installed arviz-0.18.0 cachetools-5.3.3 cons-0.4.6 dm-tree-0.1.8 etuples-0.3.9 h5netcdf-1.3.0 h5py-3.11.0 logical-unification-0.4.6 markdown-it-py-3.0.0 mdurl-0.1.2 miniKanren-1.0.3 pymc-5.15.1 pytensor-2.22.1 rich-13.7.1 xarray-einstats-0.7.0</code></pre>
</div>
</div>
<div id="cell-90" class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check powerlaw.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-101" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>data_df <span class="op">=</span> pd.read_csv(<span class="st">'bayesagent_results_df.csv'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the scatter plot</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(data_df[<span class="st">'n_experiments'</span>], data_df[<span class="st">'convergence_step'</span>], c<span class="op">=</span><span class="st">'#1a2340'</span>,alpha<span class="op">=</span><span class="fl">.2</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding labels and title</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'N-Experiments'</span>)  <span class="co"># X-axis label</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Convergence Step'</span>)  <span class="co"># Y-axis label</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Uncertainty vs N-Experiments'</span>)  <span class="co"># Title of the plot</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-91-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-112" class="cell" data-execution_count="365">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># n is the number of nodes</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co"># k is each node is connected to k nearest neighbors in ring topology</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p is the rewiring probability (set to 0 for a regular ring lattice)</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">50</span>  <span class="co"># number of nodes</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span>  <span class="co"># each node is connected to 2 nearest neighbors on either side</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.watts_strogatz_graph(n, k, <span class="fl">0.1</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the graph</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G)  <span class="co"># positions for all nodes</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>nx.draw(G, pos, with_labels<span class="op">=</span><span class="va">True</span>, node_color<span class="op">=</span><span class="st">'lightblue'</span>, edge_color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-102-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-114" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the DataFrame by network type</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>network_types <span class="op">=</span> results_df[<span class="st">'network_type'</span>].unique()</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>my_gams <span class="op">=</span> {}</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> network_type <span class="kw">in</span> network_types:</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subset the DataFrame by network type</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>    subset <span class="op">=</span> results_df[results_df[<span class="st">'network_type'</span>] <span class="op">==</span> network_type]</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> subset[[<span class="st">'n_agents'</span>]]</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> subset[<span class="st">'true_consensus'</span>].astype(<span class="bu">int</span>)  <span class="co"># Convert boolean to integer</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    gam <span class="op">=</span> LogisticGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>)).fit(X_train, y_train)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Storing the model</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>    my_gams[network_type] <span class="op">=</span> gam</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optionally, you can print out model accuracy or other statistics here</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Model for </span><span class="sc">{</span>network_type<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Accuracy on training data: </span><span class="sc">{</span>gam<span class="sc">.</span>accuracy(X_train, y_train)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Accuracy on test data: </span><span class="sc">{</span>gam<span class="sc">.</span>accuracy(X_test, y_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ModuleNotFoundError: No module named 'pygam'</code></pre>
</div>
</div>
<div id="cell-115" class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the size of the figure</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>cmap<span class="op">=</span> cmaps.colorblind_10</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>X_range <span class="op">=</span> np.linspace(X[<span class="st">'n_agents'</span>].<span class="bu">min</span>(), X[<span class="st">'n_agents'</span>].<span class="bu">max</span>(), <span class="dv">100</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span>[cmap(<span class="dv">0</span>), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N), cmap(<span class="dv">1</span><span class="op">/</span>cmap.N<span class="op">*</span><span class="dv">2</span>)]</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (network_type, gam) <span class="kw">in</span> <span class="bu">enumerate</span>(my_gams.items()):</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>    conf <span class="op">=</span> gam.confidence_intervals(X_range.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), width<span class="op">=</span><span class="fl">0.95</span>, quantiles<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(X_range, conf[:, <span class="dv">0</span>], conf[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (network_type, gam) <span class="kw">in</span> <span class="bu">enumerate</span>(my_gams.items()):</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generating a range of values for n_agents to predict and plot</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predicting with the model</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#y_pred, conf = pdep, confi = model.partial_dependence(term=0, width=.95)</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> gam.predict_proba(X_range.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plotting predicted probabilities</span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_range, y_pred,c<span class="op">=</span>colors[i], label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>network_type<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plotting observed data</span></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># observed_data = results_df[results_df['network_type'] == network_type]</span></span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.scatter(observed_data['n_agents'] + np.random.rand(len(observed_data)), observed_data['true_consensus'], </span></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#             alpha=0.01, c='grey',marker=2)</span></span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding title, labels, and legend</span></span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Effect of n_agents on True Consensus Probability'</span>)</span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Number of Agents'</span>)</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Probability of True Consensus'</span>)</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-105-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-116" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>9</code></pre>
</div>
</div>
</section>
<section id="tunable-networks" class="level1">
<h1>Tunable networks</h1>
<div id="cell-118" class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_parameters(n):</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    params_list <span class="op">=</span> []</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        n_agents <span class="op">=</span> random.randint(<span class="dv">3</span>, <span class="dv">15</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>        degree <span class="op">=</span> random.randint(<span class="dv">1</span>, n_agents<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>        p_preferential_attachment <span class="op">=</span> random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>        network <span class="op">=</span> create_hybrid_network(n_agents, degree<span class="op">=</span>degree, p_preferential_attachment<span class="op">=</span>p_preferential_attachment)</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>        uncertainty <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>        n_experiments <span class="op">=</span> <span class="dv">1000</span> <span class="co">#random.randint(1, 1000)</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> {</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_agents"</span>: n_agents,</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"degree"</span>: degree,</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"p_preferential_attachment"</span>: p_preferential_attachment,</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"network"</span>: network,</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"uncertainty"</span>: uncertainty,</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_experiments"</span>: n_experiments</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>        params_list.append(params)</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> params_list</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a list of 5 parameter dictionaries</span></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>parameter_dictionaries <span class="op">=</span> generate_parameters(<span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-119" class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>parameter_dictionaries <span class="op">=</span> generate_parameters(<span class="dv">10000</span>)  <span class="co"># Generate parameter dictionaries</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> batch_run_simulations(parameter_dictionaries, number_of_steps<span class="op">=</span><span class="dv">100000</span>, show_bar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running simulations: 100%|██████████| 10000/10000 [01:15&lt;00:00, 132.10it/s]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      n_agents  degree  p_preferential_attachment  uncertainty  n_experiments  \
0            4       2                   0.492210        0.001           1000   
1           12       7                   0.640592        0.001           1000   
2           13       3                   0.805594        0.001           1000   
3            6       5                   0.253219        0.001           1000   
4           11       5                   0.685990        0.001           1000   
...        ...     ...                        ...          ...            ...   
9995         6       5                   0.865813        0.001           1000   
9996        12       7                   0.784926        0.001           1000   
9997         6       2                   0.177675        0.001           1000   
9998         4       2                   0.691931        0.001           1000   
9999         9       1                   0.986273        0.001           1000   

      true_consensus  true_consensus_alternative_stop  
0           0.000000                         0.000000  
1           1.000000                         1.000000  
2           1.000000                         1.000000  
3           1.000000                         1.000000  
4           1.000000                         1.000000  
...              ...                              ...  
9995        0.666667                         0.666667  
9996        1.000000                         1.000000  
9997        0.000000                         0.000000  
9998        1.000000                         1.000000  
9999        0.222222                         0.222222  

[10000 rows x 7 columns]</code></pre>
</div>
</div>
<div id="cell-120" class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> results_df[[<span class="st">'n_agents'</span>, <span class="st">'degree'</span>, <span class="st">'p_preferential_attachment'</span>]]</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> results_df[<span class="st">'true_consensus'</span>].astype(<span class="bu">int</span>)  <span class="co"># Convert boolean to integer</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LogisticGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>) ).fit(X_train, y_train)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Model for </span><span class="sc">{</span>network_type<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy on training data: </span><span class="sc">{</span>gam<span class="sc">.</span>accuracy(X_train, y_train)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy on test data: </span><span class="sc">{</span>gam<span class="sc">.</span>accuracy(X_test, y_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for complete:
Accuracy on training data: 0.7221428571428572
Accuracy on test data: 0.71
LogisticGAM                                                                                               
=============================================== ==========================================================
Distribution:                      BinomialDist Effective DoF:                                     10.9616
Link Function:                        LogitLink Log Likelihood:                                 -3795.0395
Number of Samples:                         7000 AIC:                                             7612.0021
                                                AICc:                                            7612.0464
                                                UBRE:                                               3.0887
                                                Scale:                                                 1.0
                                                Pseudo R-Squared:                                   0.1478
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            4.5          0.00e+00     ***         
s(1)                              [0.6]                6            3.2          0.00e+00     ***         
s(2)                              [0.6]                6            3.3          1.09e-07     ***         
intercept                                              1            0.0          2.67e-04     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_84390/3925743412.py:14: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-121" class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose `gam` is your model and `gam.terms` contains the terms used in the model.</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First, determine the number of plots (ignoring the intercept)</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="bu">sum</span>(<span class="kw">not</span> term.isintercept <span class="cf">for</span> term <span class="kw">in</span> gam.terms)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the figure</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store y-limits</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>y_limits <span class="op">=</span> []</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span>[<span class="st">'N-Agents'</span>, <span class="st">'Degree'</span>, <span class="st">'Prb. Preferential Attachment'</span>]</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># First pass: compute the y-axis limits for all plots</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    y_limits.append((<span class="bu">min</span>(pdep.<span class="bu">min</span>(), confi.<span class="bu">min</span>()), <span class="bu">max</span>(pdep.<span class="bu">max</span>(), confi.<span class="bu">max</span>())))</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Global y limits</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>global_y_min <span class="op">=</span> <span class="bu">min</span>(limit[<span class="dv">0</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>global_y_max <span class="op">=</span> <span class="bu">max</span>(limit[<span class="dv">1</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Second pass: plot with standardized y limits</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the subplot position</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">1</span>, plot_count, current_plot)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], pdep,c<span class="op">=</span>colors[i])</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], confi, c<span class="op">=</span>colors[i], ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(XX[:, term.feature], confi[:, <span class="dv">0</span>], confi[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_y_min, global_y_max)  <span class="co"># Set global y limits</span></span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>    plt.title(labels[i])</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">''</span>)  <span class="co"># Remove x-axis label</span></span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">''</span>)  <span class="co"># Remove y-axis label</span></span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>    current_plot <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Move to the next plot position</span></span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust subplots to fit into figure area.</span></span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-110-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="randomized-networks" class="level1">
<h1>Randomized networks</h1>
<div id="cell-125" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hybrid_networks <span class="im">import</span> randomized_barabasi_albert_graph</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_parameters(n):</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    params_list <span class="op">=</span> []</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        n_agents <span class="op">=</span> random.randint(<span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>        n_edges_to_add <span class="op">=</span> random.randint(<span class="dv">1</span>, np.<span class="bu">max</span>([<span class="bu">int</span>(n_agents<span class="op">/</span><span class="dv">10</span>),<span class="dv">1</span>])) <span class="co">#rethink</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>        randomization_probability <span class="op">=</span> random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>        network <span class="op">=</span> randomized_barabasi_albert_graph(n_agents, </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>                                                    n_edges_to_add<span class="op">=</span>n_edges_to_add, </span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>                                                    randomization_probability<span class="op">=</span>randomization_probability)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>        uncertainty <span class="op">=</span> <span class="fl">0.001</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>        n_experiments <span class="op">=</span> <span class="dv">1000</span> <span class="co">#random.randint(1, 1000)</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> {</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_agents"</span>: n_agents,</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_edges_to_add"</span>: n_edges_to_add,</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"randomization_probability"</span>: randomization_probability,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">"network"</span>: network,</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"uncertainty"</span>: uncertainty,</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_experiments"</span>: n_experiments</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>        params_list.append(params)</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> params_list</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage:</span></span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a list of 5 parameter dictionaries</span></span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>parameter_dictionaries <span class="op">=</span> generate_parameters(<span class="dv">50</span>)</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-126" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>parameter_dictionaries</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>[{'n_agents': 6,
  'n_edges_to_add': 1,
  'randomization_probability': 0.3066215272629732,
  'network': &lt;networkx.classes.graph.Graph at 0x2f604c890&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 4,
  'n_edges_to_add': 1,
  'randomization_probability': 0.21376908591860166,
  'network': &lt;networkx.classes.graph.Graph at 0x2f604c390&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 64,
  'n_edges_to_add': 6,
  'randomization_probability': 0.5756424007939364,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d8fb90&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 67,
  'n_edges_to_add': 6,
  'randomization_probability': 0.8849150780526577,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9a67fd0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 44,
  'n_edges_to_add': 3,
  'randomization_probability': 0.46759915539183294,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d85b10&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 73,
  'n_edges_to_add': 4,
  'randomization_probability': 0.7169514776005941,
  'network': &lt;networkx.classes.graph.Graph at 0x2b8dd9910&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 29,
  'n_edges_to_add': 1,
  'randomization_probability': 0.6007559952641881,
  'network': &lt;networkx.classes.graph.Graph at 0x33423ed10&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 22,
  'n_edges_to_add': 2,
  'randomization_probability': 0.03341992042605968,
  'network': &lt;networkx.classes.graph.Graph at 0x3347b1510&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 11,
  'n_edges_to_add': 1,
  'randomization_probability': 0.1410394459333425,
  'network': &lt;networkx.classes.graph.Graph at 0x3347460d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 7,
  'n_edges_to_add': 1,
  'randomization_probability': 0.8158277327373287,
  'network': &lt;networkx.classes.graph.Graph at 0x3347421d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 32,
  'n_edges_to_add': 2,
  'randomization_probability': 0.004377616886368507,
  'network': &lt;networkx.classes.graph.Graph at 0x33423cd90&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 72,
  'n_edges_to_add': 5,
  'randomization_probability': 0.763254920772748,
  'network': &lt;networkx.classes.graph.Graph at 0x3347408d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 19,
  'n_edges_to_add': 1,
  'randomization_probability': 0.24237636417241626,
  'network': &lt;networkx.classes.graph.Graph at 0x33412b710&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 67,
  'n_edges_to_add': 3,
  'randomization_probability': 0.9930451842359124,
  'network': &lt;networkx.classes.graph.Graph at 0x334189a50&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 62,
  'n_edges_to_add': 6,
  'randomization_probability': 0.19682177143576896,
  'network': &lt;networkx.classes.graph.Graph at 0x334404390&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 17,
  'n_edges_to_add': 1,
  'randomization_probability': 0.6697187844889149,
  'network': &lt;networkx.classes.graph.Graph at 0x2ba042d10&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 19,
  'n_edges_to_add': 1,
  'randomization_probability': 0.140141139801076,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d8ef50&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 92,
  'n_edges_to_add': 3,
  'randomization_probability': 0.4868867871030451,
  'network': &lt;networkx.classes.graph.Graph at 0x2f7439890&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 46,
  'n_edges_to_add': 3,
  'randomization_probability': 0.11771970476652927,
  'network': &lt;networkx.classes.graph.Graph at 0x2f7502e50&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 41,
  'n_edges_to_add': 3,
  'randomization_probability': 0.6523131805313358,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9be5d50&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 25,
  'n_edges_to_add': 2,
  'randomization_probability': 0.9423007859093103,
  'network': &lt;networkx.classes.graph.Graph at 0x333d5d2d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 69,
  'n_edges_to_add': 6,
  'randomization_probability': 0.006988176290469328,
  'network': &lt;networkx.classes.graph.Graph at 0x33431c290&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 33,
  'n_edges_to_add': 3,
  'randomization_probability': 0.027683403732915446,
  'network': &lt;networkx.classes.graph.Graph at 0x333d32710&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 92,
  'n_edges_to_add': 2,
  'randomization_probability': 0.11112484919799437,
  'network': &lt;networkx.classes.graph.Graph at 0x333dbe010&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 60,
  'n_edges_to_add': 3,
  'randomization_probability': 0.4506258947807338,
  'network': &lt;networkx.classes.graph.Graph at 0x33430f290&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 5,
  'n_edges_to_add': 1,
  'randomization_probability': 0.29238014947880153,
  'network': &lt;networkx.classes.graph.Graph at 0x33414f6d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 75,
  'n_edges_to_add': 1,
  'randomization_probability': 0.838362435307055,
  'network': &lt;networkx.classes.graph.Graph at 0x334794ed0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 56,
  'n_edges_to_add': 3,
  'randomization_probability': 0.5639948699096556,
  'network': &lt;networkx.classes.graph.Graph at 0x334721a90&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 20,
  'n_edges_to_add': 2,
  'randomization_probability': 0.5189237144493457,
  'network': &lt;networkx.classes.graph.Graph at 0x3342697d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 33,
  'n_edges_to_add': 1,
  'randomization_probability': 0.6831969805673042,
  'network': &lt;networkx.classes.graph.Graph at 0x333fa0d10&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 35,
  'n_edges_to_add': 2,
  'randomization_probability': 0.757081253375074,
  'network': &lt;networkx.classes.graph.Graph at 0x33426b250&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 92,
  'n_edges_to_add': 2,
  'randomization_probability': 0.5792285979730575,
  'network': &lt;networkx.classes.graph.Graph at 0x333e127d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 3,
  'n_edges_to_add': 1,
  'randomization_probability': 0.49395023010536665,
  'network': &lt;networkx.classes.graph.Graph at 0x33430c310&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 100,
  'n_edges_to_add': 4,
  'randomization_probability': 0.6734871576467824,
  'network': &lt;networkx.classes.graph.Graph at 0x333e120d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 22,
  'n_edges_to_add': 1,
  'randomization_probability': 0.45670445074071875,
  'network': &lt;networkx.classes.graph.Graph at 0x33431fa50&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 67,
  'n_edges_to_add': 4,
  'randomization_probability': 0.228715289109652,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9be71d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 52,
  'n_edges_to_add': 3,
  'randomization_probability': 0.07897501756371605,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d84710&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 13,
  'n_edges_to_add': 1,
  'randomization_probability': 0.27744289938762623,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d0cad0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 48,
  'n_edges_to_add': 4,
  'randomization_probability': 0.28175448052759,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d0e710&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 18,
  'n_edges_to_add': 1,
  'randomization_probability': 0.42869456606289325,
  'network': &lt;networkx.classes.graph.Graph at 0x333dc0750&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 35,
  'n_edges_to_add': 2,
  'randomization_probability': 0.8728990053077195,
  'network': &lt;networkx.classes.graph.Graph at 0x2b9d31890&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 90,
  'n_edges_to_add': 4,
  'randomization_probability': 0.5599013374988473,
  'network': &lt;networkx.classes.graph.Graph at 0x334309490&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 62,
  'n_edges_to_add': 4,
  'randomization_probability': 0.7716935791696736,
  'network': &lt;networkx.classes.graph.Graph at 0x333d8b2d0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 41,
  'n_edges_to_add': 3,
  'randomization_probability': 0.10243695838798361,
  'network': &lt;networkx.classes.graph.Graph at 0x333eccad0&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 88,
  'n_edges_to_add': 3,
  'randomization_probability': 0.1237325712977645,
  'network': &lt;networkx.classes.graph.Graph at 0x334177050&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 33,
  'n_edges_to_add': 2,
  'randomization_probability': 0.6210694113577311,
  'network': &lt;networkx.classes.graph.Graph at 0x333d7de90&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 91,
  'n_edges_to_add': 3,
  'randomization_probability': 0.9072006028881778,
  'network': &lt;networkx.classes.graph.Graph at 0x333d7f050&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 62,
  'n_edges_to_add': 4,
  'randomization_probability': 0.07842971765539963,
  'network': &lt;networkx.classes.graph.Graph at 0x3347f5490&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 39,
  'n_edges_to_add': 3,
  'randomization_probability': 0.760999315201459,
  'network': &lt;networkx.classes.graph.Graph at 0x333cee450&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000},
 {'n_agents': 11,
  'n_edges_to_add': 1,
  'randomization_probability': 0.6541618154418407,
  'network': &lt;networkx.classes.graph.Graph at 0x333db2690&gt;,
  'uncertainty': 0.001,
  'n_experiments': 1000}]</code></pre>
</div>
</div>
<div id="cell-127" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the network from the parameter dictionary</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> parameter_dictionaries[<span class="dv">0</span>]</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(params)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>network <span class="op">=</span> params[<span class="st">'network'</span>]</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a graph from the network</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> nx.Graph(network)</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the graph</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>nx.draw(graph, with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'n_agents': 6, 'n_edges_to_add': 1, 'randomization_probability': 0.3066215272629732, 'network': &lt;networkx.classes.graph.Graph object at 0x2f604c890&gt;, 'uncertainty': 0.001, 'n_experiments': 1000}</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-115-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-128" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>parameter_dictionaries <span class="op">=</span> generate_parameters(<span class="dv">10000</span>)  <span class="co"># Generate parameter dictionaries</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> run_simulations(parameter_dictionaries, number_of_steps<span class="op">=</span><span class="dv">100000</span>, show_bar<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>display(results_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running simulations: 100%|██████████| 10000/10000 [09:41&lt;00:00, 17.18it/s]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">n_agents</th>
<th data-quarto-table-cell-role="th">n_edges_to_add</th>
<th data-quarto-table-cell-role="th">randomization_probability</th>
<th data-quarto-table-cell-role="th">uncertainty</th>
<th data-quarto-table-cell-role="th">n_experiments</th>
<th data-quarto-table-cell-role="th">true_consensus</th>
<th data-quarto-table-cell-role="th">true_consensus_alternative_stop</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>35</td>
<td>1</td>
<td>0.465802</td>
<td>0.001</td>
<td>1000</td>
<td>0.828571</td>
<td>0.828571</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7</td>
<td>1</td>
<td>0.126811</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>39</td>
<td>3</td>
<td>0.870653</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>8</td>
<td>1</td>
<td>0.697600</td>
<td>0.001</td>
<td>1000</td>
<td>0.875000</td>
<td>0.875000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>64</td>
<td>2</td>
<td>0.709067</td>
<td>0.001</td>
<td>1000</td>
<td>0.968750</td>
<td>0.968750</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9995</td>
<td>44</td>
<td>4</td>
<td>0.453453</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9996</td>
<td>16</td>
<td>1</td>
<td>0.161439</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9997</td>
<td>67</td>
<td>2</td>
<td>0.138573</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9998</td>
<td>36</td>
<td>3</td>
<td>0.367534</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">9999</td>
<td>100</td>
<td>5</td>
<td>0.997589</td>
<td>0.001</td>
<td>1000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

<p>10000 rows × 7 columns</p>
</div>
</div>
</div>
</div>
<div id="cell-130" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Preparing the data</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> results_df[[<span class="st">'n_agents'</span>, <span class="st">'n_edges_to_add'</span>, <span class="st">'randomization_probability'</span>]]</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> results_df[<span class="st">'true_consensus'</span>].astype(<span class="bu">int</span>)  <span class="co"># Convert boolean to integer</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting the data into training and testing sets for model validation</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the Logistic GAM model</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>gam <span class="op">=</span> LogisticGAM(s(<span class="dv">0</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">1</span>,n_splines<span class="op">=</span><span class="dv">6</span>) <span class="op">+</span> s(<span class="dv">2</span>,n_splines<span class="op">=</span><span class="dv">6</span>) ).fit(X_train, y_train)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Model for </span><span class="sc">{</span>network_type<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy on training data: </span><span class="sc">{</span>gam<span class="sc">.</span>accuracy(X_train, y_train)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Accuracy on test data: </span><span class="sc">{</span>gam<span class="sc">.</span>accuracy(X_test, y_test)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(gam.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model for complete:
Accuracy on training data: 0.8481428571428572
Accuracy on test data: 0.8496666666666667
LogisticGAM                                                                                               
=============================================== ==========================================================
Distribution:                      BinomialDist Effective DoF:                                      9.5573
Link Function:                        LogitLink Log Likelihood:                                 -2388.4934
Number of Samples:                         7000 AIC:                                             4796.1014
                                                AICc:                                            4796.1363
                                                UBRE:                                               2.6862
                                                Scale:                                                 1.0
                                                Pseudo R-Squared:                                   0.4996
==========================================================================================================
Feature Function                  Lambda               Rank         EDoF         P &gt; x        Sig. Code   
================================= ==================== ============ ============ ============ ============
s(0)                              [0.6]                6            4.1          0.00e+00     ***         
s(1)                              [0.6]                6            2.4          0.00e+00     ***         
s(2)                              [0.6]                6            3.1          0.00e+00     ***         
intercept                                              1            0.0          1.22e-15     ***         
==========================================================================================================
Significance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

WARNING: Fitting splines and a linear function to a feature introduces a model identifiability problem
         which can cause p-values to appear significant when they are not.

WARNING: p-values calculated in this manner behave correctly for un-penalized models or models with
         known smoothing parameters, but when smoothing parameters have been estimated, the p-values
         are typically lower than they should be, meaning that the tests reject the null too readily.
None</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/hz/4s_tpd8s47xfzz7rhhfjdbb00000gn/T/ipykernel_84390/2392922359.py:14: UserWarning: KNOWN BUG: p-values computed in this summary are likely much smaller than they should be. 
 
Please do not make inferences based on these values! 

Collaborate on a solution, and stay up to date at: 
github.com/dswah/pyGAM/issues/163 

  print(gam.summary())</code></pre>
</div>
</div>
<div id="cell-131" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose `gam` is your model and `gam.terms` contains the terms used in the model.</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First, determine the number of plots (ignoring the intercept)</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>plot_count <span class="op">=</span> <span class="bu">sum</span>(<span class="kw">not</span> term.isintercept <span class="cf">for</span> term <span class="kw">in</span> gam.terms)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Start the figure</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))  <span class="co"># Adjust the size as needed</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store y-limits</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>y_limits <span class="op">=</span> []</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span>[<span class="st">'N-Agents'</span>, <span class="st">'n_edges_to_add'</span>, <span class="st">'randomization_probability'</span>]</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="co"># First pass: compute the y-axis limits for all plots</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>    y_limits.append((<span class="bu">min</span>(pdep.<span class="bu">min</span>(), confi.<span class="bu">min</span>()), <span class="bu">max</span>(pdep.<span class="bu">max</span>(), confi.<span class="bu">max</span>())))</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Global y limits</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>global_y_min <span class="op">=</span> <span class="bu">min</span>(limit[<span class="dv">0</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>global_y_max <span class="op">=</span> <span class="bu">max</span>(limit[<span class="dv">1</span>] <span class="cf">for</span> limit <span class="kw">in</span> y_limits)</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Second pass: plot with standardized y limits</span></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>current_plot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, term <span class="kw">in</span> <span class="bu">enumerate</span>(gam.terms):</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> term.isintercept:</span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span></span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>    XX <span class="op">=</span> gam.generate_X_grid(term<span class="op">=</span>i)</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>    pdep, confi <span class="op">=</span> gam.partial_dependence(term<span class="op">=</span>i, X<span class="op">=</span>XX, width<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set the subplot position</span></span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">1</span>, plot_count, current_plot)</span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], pdep,c<span class="op">=</span>colors[i])</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>    plt.plot(XX[:, term.feature], confi, c<span class="op">=</span>colors[i], ls<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a>    plt.fill_between(XX[:, term.feature], confi[:, <span class="dv">0</span>], confi[:, <span class="dv">1</span>], facecolor<span class="op">=</span>colors[i], alpha<span class="op">=</span><span class="fl">0.2</span>, interpolate<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>    plt.ylim(global_y_min, global_y_max)  <span class="co"># Set global y limits</span></span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a>    plt.title(labels[i])</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">''</span>)  <span class="co"># Remove x-axis label</span></span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">''</span>)  <span class="co"># Remove y-axis label</span></span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>    current_plot <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Move to the next plot position</span></span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust subplots to fit into figure area.</span></span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="plotting_results_files/figure-html/cell-119-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>